<?xml version="1.0" encoding="utf-8" ?>
<mdscript name="Tpwar_Menus" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="D:/x4_extract_2.5/libraries/md.xsd">
    <cues>
        <!-- Helper.color = {
	black = { r = 0, g = 0, b = 0, a = 100 },
	slidervalue = { r = 71, g = 136, b = 184, a = 100 },
	green = { r = 0, g = 255, b = 0, a = 100 },
	playergreen = { r = 170, g = 255, b = 139, a = 100 },
	grey = { r = 128, g = 128, b = 128, a = 100 },
	lightgreen = { r = 100, g = 225, b = 0, a = 100 },
	lightgrey = { r = 192, g = 192, b = 192, a = 100 },
	orange = { r = 255, g = 192, b = 0, a = 100 },
	darkorange = { r = 128, g = 95, b = 0, a = 100 },
	red = { r = 255, g = 0, b = 0, a = 100 },
	semitransparent = { r = 0, g = 0, b = 0, a = 95 },
	transparent60 = { r = 0, g = 0, b = 0, a = 60 },
	transparent = { r = 0, g = 0, b = 0, a = 0 },
	white = { r = 255, g = 255, b = 255, a = 100 },
	yellow = { r = 144, g = 144, b = 0, a = 100 },
	brightyellow = { r = 255, g = 255, b = 0, a = 100 },
	warning = { r = 192, g = 192, b = 0, a = 100 },
	done = { r = 38, g = 61, b = 78, a = 100 },
	available = { r = 7, g = 29, b = 46, a = 100 },
	darkgrey = { r = 32, g = 32, b = 32, a = 100 },
	mission = { r = 255, g = 190, b = 0, a = 100 },
	warningorange = { r = 255, g = 138, b = 0, a = 100 },
	blue = { r = 90, g = 146, b = 186, a = 100 },
} -->
        <cue name="Init">
            <conditions>
                <event_cue_signalled />
            </conditions>
            <actions>
                <debug_to_file text="'Tpwar_Menus'" name="'Loadorder.log'" directory="'Debug'" chance="global.$TpwarDebugChance" />
                <create_group groupname="$DeathGroup" />
                <create_list name="$ContractsList" />
                <debug_to_file text="'start'" name="'tpmenu.log'" directory="'tpmenu'" append="false" chance="global.$TpwarDebugChance" />
                <create_list name="$TransactionLog" />
                <append_to_list name="$TransactionLog" exact="'Player Money State'" />
            </actions>
            <cues>
                <cue name="Close_Menu" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <debug_text text="'close menu cue activated'" />
                    </actions>
                </cue>
                <cue name="Main_Menu" instantiate="true">
                    <conditions>
                        <check_any>
                            <event_cue_signalled />
                            <event_player_activated_weapongroup weapongroup="2" />
                        </check_any>
                    </conditions>
                    <actions>
                        <set_value name="$ObjectTable" exact="table[
                            {1} = table [
                                $Return = Debug_Warp,
                                $Name = 'Debug Warp',
                                ],
                            {2} = table [
                                $Return = Display_Merc,
                                $Name = 'Mercenary Contracts',
                                ],
                            {3} = table [
                                $Return = Debug_Globals,
                                $Name = 'Debug Globals',
                                ],
                            {4} = table [
                                $Return = Debug_Galaxy,
                                $Name = 'Debug Galaxy',
                                ],
                            {5} = table [
                                $Return = Transaction_Log,
                                $Name = 'Transaction Log',
                                ],
                            {6} = table [
                                $Return = FOS,
                                $Name = 'FOS Device',
                                ],
                        ]" />
                    </actions>
                    <cues>
                        <cue name="Main_Menu_Call_Menu_LIB" ref="md.Tpwar_Menus.Menu_LIB">
                            <param name="Title" value="'Teleportation Wars'" />
                            <param name="MenuType" value="'main'" />
                            <param name="ObjectTable" value="$ObjectTable" />
                            <param name="ButtonText" value="'Open Menu'" />
                        </cue>
                    </cues>
                </cue>
                <cue name="FOS" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="$ObjectTable" exact="table[]" />
                        <find_object groupname="$Object" space="player.sector" multiple="true" />
                        <debug_text text="'$Object FOS THING' + $Object" />
                        <do_all exact="$Object.count" counter="$i">
                            <do_if value="not $ObjectTable.{$Object.{$i}.owner}.$Objects?">
                                <set_value name="$ObjectTable.{$Object.{$i}.owner}" exact="table[]" />
                                <set_value name="$ObjectTable.{$Object.{$i}.owner}.$Objects" exact="[]" />
                                <set_value name="$ObjectTable.{$Object.{$i}.owner}.$Button" exact="true" />
                            </do_if>
                            <append_to_list name="$ObjectTable.{$Object.{$i}.owner}.$Objects" exact="$Object.{$i}" />
                        </do_all>
                        <debug_text text="'$Object FOS THING' + $ObjectTable" />
                    </actions>
                    <cues>
                        <cue name="FOS_Call_Menu_LIB" ref="md.Tpwar_Menus.Menu_LIB">
                            <param name="Title" value="'Find Ownerless Scan'" />
                            <param name="MenuType" value="'object'" />
                            <param name="ReturnCue" value="FOS_Guidance" />
                            <param name="ObjectTable" value="$ObjectTable" />
                            <param name="ButtonText" value="'Set Guidance'" />
                        </cue>
                    </cues>
                </cue>
                <cue name="FOS_Guidance" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <signal_cue_instantly cue="md.Guidance.NewTarget" param="[event.param.$echo, null]" />
                        <!-- <set_value name="$Objective" exact="objective.guidance" /> -->
                    </actions>
                </cue>
                <cue name="Transaction_Log_PlayerMoney" instantiate="true">
                    <conditions>
                        <event_player_money_updated />
                    </conditions>
                    <actions>
                        <append_to_list name="$TransactionLog" exact="event.param2" />
                    </actions>
                </cue>
                <cue name="Transaction_Log" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <!-- TODO -->
                    </actions>
                    <cues>
                        <cue name="Transaction_Log_Call_Menu_LIB" ref="md.Tpwar_Menus.Menu_LIB">
                            <param name="Title" value="'Transaction Log'" />
                            <param name="MenuType" value="'list'" />
                            <param name="ObjectTable" value="$TransactionLog" />
                        </cue>
                    </cues>
                </cue>
                <cue name="Debug_Globals" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="$ObjectTable" exact="table[
                            {1} = table [
                                $Return = Toggle_Debug,
                                $Name = 'Toggle Debug',
                                ],
                            {2} = table [
                                $Return = Toggle_FuelCost,
                                $Name = 'Toggle Fuel',
                                ],
                            {2} = table [
                                $Return = Toggle_GalaxyDebug,
                                $Name = 'Toggle Galaxy Debug',
                                ],
                        ]" />
                    </actions>
                    <cues>
                        <cue name="Debug_Globals_Call_Menu_LIB" ref="md.Tpwar_Menus.Menu_LIB">
                            <param name="Title" value="'Debug Globals'" />
                            <param name="MenuType" value="'main'" />
                            <param name="ReturnCue" value="Main_Menu" />
                            <param name="ObjectTable" value="$ObjectTable" />
                            <param name="ButtonText" value="'Toggle'" />
                        </cue>
                    </cues>
                </cue>
                <cue name="Toggle_Debug" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="global.$TpwarDebugChance" exact="if global.$TpwarDebugChance == 100 then 0 else 100" />
                    </actions>
                </cue>
                <cue name="Toggle_FuelCost" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <destroy_group group="md.Tpwar_Menus.Merc_Listener.$DeathGroup" />
                        <set_value name="global.$TpwarFuelCost" exact="if global.$TpwarFuelCost == 100 then 0 else 100" />
                    </actions>
                </cue>
                <cue name="Toggle_GalaxyDebug" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="global.$TpwarGalaxyDebug" exact="if global.$TpwarGalaxyDebug == 100 then 0 else 100" />
                    </actions>
                </cue>
                <cue name="Debug_Galaxy" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions></actions>
                    <cues>
                        <cue name="Debug_Galaxy_Call_Menu_LIB" ref="md.Tpwar_Menus.Menu_LIB">
                            <param name="Title" value="'Debug Galaxy'" />
                            <param name="GalDebug" value="true" />
                            <param name="ObjectTable" value="global.$GalaxyObjectTable" />
                        </cue>
                    </cues>
                </cue>
                <cue name="Debug_WarpTo" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="$Object" exact="event.param.$echo" />
                        <set_value name="$Valid" exact="true" />
                        <!-- <set_value name="$Valid" exact="false" /> -->
                        <!-- <include_actions ref="ValidateKnown" /> -->
                        <do_if value="$Valid == true">
                            <warp object="player.ship" sector="$Object">
                                <position object="$Object" exact="2km" />
                            </warp>
                        </do_if>
                    </actions>
                </cue>
                <cue name="Debug_Warp" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="$ObjectTable" exact="table[]" />
                        <find_sector name="$Sectors" space="player.galaxy" multiple="true" />
                        <do_all exact="$Sectors.count" counter="$i">
                            <do_if value="not $ObjectTable.{$Sectors.{$i}.owner}.$Objects?">
                                <set_value name="$ObjectTable.{$Sectors.{$i}.owner}" exact="table[]" />
                                <set_value name="$ObjectTable.{$Sectors.{$i}.owner}.$Objects" exact="[]" />
                                <set_value name="$ObjectTable.{$Sectors.{$i}.owner}.$Button" exact="true" />
                            </do_if>
                            <append_to_list name="$ObjectTable.{$Sectors.{$i}.owner}.$Objects" exact="$Sectors.{$i}" />
                        </do_all>
                    </actions>
                    <cues>
                        <cue name="Debug_Warp_Call_Menu_LIB" ref="md.Tpwar_Menus.Menu_LIB">
                            <param name="Title" value="'Debug Warp'" />
                            <param name="ReturnCue" value="Debug_WarpTo" />
                            <param name="ObjectTable" value="$ObjectTable" />
                            <param name="ButtonText" value="'Warp'" />
                        </cue>
                    </cues>
                </cue>
                <cue name="Display_Merc" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="$ObjectTable" exact="table[]" />
                        <do_all exact="$ContractsList.count" counter="$i">
                            <do_if value="not $ObjectTable.{$ContractsList.{$i}.owner}.$Objects?">
                                <set_value name="$ObjectTable.{$ContractsList.{$i}.owner}" exact="table[]" />
                                <set_value name="$ObjectTable.{$ContractsList.{$i}.owner}.$Objects" exact="[]" />
                                <set_value name="$ObjectTable.{$ContractsList.{$i}.owner}.$Button" exact="true" />
                            </do_if>
                            <append_to_list name="$ObjectTable.{$ContractsList.{$i}.owner}.$Objects" exact="$ContractsList.{$i}" />
                        </do_all>
                    </actions>
                    <cues>
                        <cue name="Display_Merc_Call_Menu_LIB" ref="md.Tpwar_Menus.Menu_LIB">
                            <param name="Title" value="'Mercenary Contracts'" />
                            <param name="ObjectTable" value="$ObjectTable" />
                            <param name="Blackboard" value="true" />
                            <param name="ButtonText" value="'Cancel'" />
                        </cue>
                    </cues>
                </cue>
                <cue name="StartConversation" instantiate="true">
                    <conditions>
                        <check_any>
                            <event_conversation_started conversation="default" />
                            <event_conversation_returned_to_section section="default" />
                        </check_any>
                    </conditions>
                    <actions>
                        <do_if value="event.object.container.isclass.ship">
                            <add_player_choice_sub text="'Mecenary Work'" tooltip="'Open Stock Trading Menu'" section="Open_From_Convo" />
                        </do_if>
                    </actions>
                </cue>
                <!-- TODO clean up this  -->
                <cue name="Open_From_Convo" instantiate="true">
                    <conditions>
                        <event_conversation_next_section section="Open_From_Convo" />
                        <!-- <event_player_activated_weapongroup /> -->
                    </conditions>
                    <actions>
                        <signal_cue_instantly cue="Open_Menu" param="event.object" />
                    </actions>
                </cue>
                <cue name="Open_Menu" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                        <!-- <event_player_activated_weapongroup /> -->
                    </conditions>
                    <actions>
                        <do_if value="not $ContractOffer?">
                            <set_value name="event.param.$ContractOffer" exact="true" />
                            <set_value name="event.param.$Income" min="1.0" max="3.0" scale="4" profile="bell" />
                            <set_value name="event.param.$Failure" exact="(event.param.container.macro.ware.averageprice / 100)i" />
                        </do_if>
                        <do_if value="typeof event.param != datatype.list">
                            <set_value name="$Object" exact="[event.param]" />
                        </do_if>
                        <do_else>
                            <set_value name="$Object" exact="event.param" />
                        </do_else>
                        <!-- generate contract -->
                        <set_value name="$ObjectTable" exact="table[]" />
                        <do_all exact="$Object.count" counter="$i">
                            <do_if value="not $ObjectTable.{$Object.{$i}.owner}.$Objects?">
                                <set_value name="$ObjectTable.{$Object.{$i}.owner}" exact="table[]" />
                                <set_value name="$ObjectTable.{$Object.{$i}.owner}.$Objects" exact="[]" />
                                <set_value name="$ObjectTable.{$Object.{$i}.owner}.$Button" exact="true" />
                            </do_if>
                            <append_to_list name="$ObjectTable.{$Object.{$i}.owner}.$Objects" exact="$Object.{$i}" />
                        </do_all>
                        <set_value name="$Object" exact="event.param" />
                        <debug_text text="'ObjectTable print' + $ObjectTable" />
                    </actions>
                    <cues>
                        <cue name="Call_Menu_LIB" ref="md.Tpwar_Menus.Menu_LIB">
                            <param name="Title" value="'Contract Offer'" />
                            <param name="ObjectTable" value="$ObjectTable" />
                            <param name="Blackboard" value="true" />
                            <param name="ButtonText" value="'Accept Contract'" />
                            <param name="ReturnCue" value="Merc_Listener" />
                        </cue>
                    </cues>
                </cue>
                <cue name="Merc_Listener" instantiate="true">
                    <conditions>
                        <check_any>
                            <event_object_destroyed group="$DeathGroup" />
                            <event_cue_signalled />
                        </check_any>
                    </conditions>
                    <actions>
                        <do_if value="event.param.$echo.indexof.{$ContractsList} == 0">
                            <append_to_list name="$ContractsList" exact="event.param.$echo" />
                            <set_value name="event.param.$echo.$Contracted" exact="true" />
                            <set_value name="event.param.$echo.$ContractDate" exact="player.age" />
                            <add_to_group groupname="$DeathGroup" object="event.param.$echo.container" />
                        </do_if>
                        <do_if value="event.name == 'event_object_destroyed'">
                            <transfer_money from="faction.player" to="event.object.owner" amount="event.object.pilot.$Failure" />
                        </do_if>
                    </actions>
                </cue>
                <!-- small namespace issue -->
                <cue name="MercenaryTradeStart" instantiate="true">
                    <conditions>
                        <event_object_docked group="$DeathGroup" />
                    </conditions>
                    <actions>
                        <set_value name="$wares" exact="table[]" />
                        <set_value name="$warelist" exact="event.object.cargo.list" />
                        <do_all exact="$warelist.count" counter="$ware">
                            <set_value name="$tradeware" exact="$warelist.{$ware}" />
                            <set_value name="$tradecount" exact="event.object.cargo.{$tradeware}.count" />
                            <set_value name="$wares.{$ware}" exact="table[
                                    $waretotrade = $tradeware,
                                    $waretotradecount = $tradecount
                                     ]" />
                        </do_all>
                        <set_value name="$Object" exact="event.object" />
                    </actions>
                    <cues>
                        <cue name="MercenaryTradeComplete">
                            <conditions>
                                <event_object_undocked object="$Object" />
                            </conditions>
                            <actions>
                                <do_all exact="$wares.keys.count" counter="$key">
                                    <set_value name="$wareselected" exact="$wares.{$key}.$waretotrade" />
                                    <set_value name="$Diff" exact="$wares.{$key}.$waretotradecount - event.object.cargo.{$wareselected}.count" />
                                    <do_if value="$Diff gt 0">
                                        <set_value name="$Money" exact="$wares.{$key}.$waretotrade.averageprice * $Diff / 10" />
                                        <transfer_money from="event.object.owner" to="faction.player" amount="$Money" />
                                    </do_if>
                                </do_all>
                            </actions>
                        </cue>
                    </cues>
                </cue>
            </cues>
        </cue>
        <library name="Menu_LIB">
            <params>
                <param name="Title" default="'Menu'" />
                <param name="ReturnCue" default="Main_Menu" />
                <param name="MenuType" default="'object'" />
                <param name="Interaction" default="'button'" />
                <param name="ButtonText" default="'button'" />
                <param name="DefaultName" default="'knownname'" />
                <param name="ObjectTable" default="null" />
                <param name="Blackboard" default="false" />
                <param name="GalDebug" default="false" />
                <param name="Object" default="'none'" />
                <param name="Col" default="2" />
                <param name="Height" default="300" />
                <param name="Width" default="600" />
            </params>
            <cues>
                <cue name="DrawMenu">
                    <actions>
                        <include_actions ref="StartMenu" />
                        <do_if value="$MenuType == 'object'">
                            <set_value name="$Keys" exact="$ObjectTable.keys.list" />
                            <do_all exact="$Keys.count" counter="$i">
                                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                                <set_value name="$Text" exact="$Keys.{$i}.name" />
                                <!-- <set_value name="$TitleColor" exact="" /> -->
                                <include_actions ref="TitleLabel" />
                                <do_all exact="$ObjectTable.{$Keys.{$i}}.$Objects.count" counter="$j">
                                    <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                                    <do_if value="$ObjectTable.{$Keys.{$i}}.$Objects != null and $ObjectTable.{$Keys.{$i}}.$Objects.{1} != 'none'">
                                        <set_value name="$Text" exact="$ObjectTable.{$Keys.{$i}}.$Objects.{$j}.knownname" />
                                    </do_if>
                                    <set_value name="$Object" exact="$ObjectTable.{$Keys.{$i}}.$Objects.{$j}" />
                                    <do_if value="$Blackboard == true">
                                        <set_value name="$Text" exact="'Pilot: \033B %s \033X \nShip: \033B %s \033X \n -  percent of income:\033G %s \033X, \n -  penalty for failure:\033R %s \033X'
                                        .[$Text,$Object.ship.knownname,  $Object.$Income, $Object.$Failure]" />
                                    </do_if>
                                    <do_if value="$GalDebug == true">
                                        <set_value name="$Text" exact="
'StartingShips: %s\n
StartingStations: %s\n
ShipsLost: %s\n
StationsLost: %s\n
ShipsCreated: %s,\n
StationsCreated: %s\n'
.[$ObjectTable.{$Keys.{$i}}.$StartingShips.count,
$ObjectTable.{$Keys.{$i}}.$StartingStations.count,
$ObjectTable.{$Keys.{$i}}.$ShipsLost,
$ObjectTable.{$Keys.{$i}}.$StationsLost,
$ObjectTable.{$Keys.{$i}}.$ShipsCreated, 
$ObjectTable.{$Keys.{$i}}.$StationsCreated]" />
                                    </do_if>
                                    <include_actions ref="Label" />
                                    <do_if value="$ObjectTable.{$Keys.{$i}}.$Button == true">
                                        <include_actions ref="Button" />
                                    </do_if>
                                </do_all>
                            </do_all>
                        </do_if>
                        <do_if value="$MenuType == 'main'">
                            <do_all exact="$ObjectTable.keys.count" counter="$i">
                                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                                <set_value name="$Text" exact="$ObjectTable.{$i}.$Name" />
                                <include_actions ref="Label" />
                                <set_value name="$ReturnCue" exact="$ObjectTable.{$i}.$Return" />
                                <include_actions ref="Button" />
                            </do_all>
                        </do_if>
                        <do_if value="$MenuType == 'list'">
                            <do_all exact="$ObjectTable.count" counter="$i">
                                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                                <set_value name="$Text" exact="$ObjectTable.{$i} + ' '" />
                                <include_actions ref="Label" />
                            </do_all>
                        </do_if>
                        <do_if value="$MenuType == 'properties'">
                            <do_all exact="$ObjectTable.keys.count" counter="$i">
                                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                                <set_value name="$Text" exact="$ObjectTable.{$i}.$Name" />
                                <include_actions ref="Label" />
                                <set_value name="$INKeys" exact="$ObjectTable.{$i}.keys.list" />
                                <do_all exact="$INKeys.count" counter="$j">
                                    <set_value name="$Text" exact="$INKeys.{$j}" />
                                    <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                                    <include_actions ref="Label" />
                                    <set_value name="$Text" exact="$ObjectTable.{$i}.{$INKeys.{$j}} + ' '" />
                                    <include_actions ref="Label" />
                                </do_all>
                            </do_all>
                        </do_if>
                        <!-- debug -->
                        <debug_to_file text="'%s | %s | %s'.[player.age, Menu_LIB, this.parent]" name="'tpmenu.log'" directory="'tpmenu'" />
                    </actions>
                </cue>
            </cues>
        </library>
        <library name="StartMenu">
            <actions>
                <signal_cue_instantly cue="md.Simple_Menu_API.Create_Menu" param="table[
                                        $columns = $Col, 
                                        $title = $Title,
                                        $height = $Height,
                                        $width = $Width,
                                        $onClose_cue= md.Tpwar_Menus.Close_Menu
                                        ]" />
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                <do_if value="$MenuType != 'main'">
                    <signal_cue_instantly cue="md.Simple_Menu_API.Make_Label" param="table[
                                        $col=1, 
                                        $text = 'Return To Teleportation Wars Menu',
                                        ]" />
                    <signal_cue_instantly cue="md.Simple_Menu_API.Make_Button" param="table[
                                        $col=2, 
                                        $text=table[$text='Select', $color='Helper.color.brightyellow'], 
                                        $onClick= md.Tpwar_Menus.Main_Menu,
                                        ]" />
                </do_if>
            </actions>
        </library>
        <library name="Button">
            <actions>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Button" param="table[
                                        $col=2,
                                        $text=table[$text=$ButtonText, $color='Helper.color.brightyellow'], 

                                        $onClick= $ReturnCue,
                                        $echo = $Object,
                                        $icon = table[

                                            $icon='order_plunder',
                                            $swapicon='order_plunder',
                                            $width=32,
                                            $height=64,
                                            $x=0,
                                            $y=0,
                                            $color='Helper.color.brightyellow',
                                            $scaling=true]
                                        ]" />
            </actions>
        </library>
        <library name="Label">
            <actions>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Label" param="table[
                                        $col=1, 
                                        
                                        $text = $Text,
                                         $color=table[ $r = 200, $g = 200, $b = 200, $a = 100 ],
                                        ]" />
            </actions>
        </library>
        <library name="TitleLabel">
            <actions>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Label" param="table[
                                        $col=1, 
                                        
                                        $text = $Text,
                                        $titleColor = 'Helper.color.brightyellow',
                                         $color=table[ $r = 200, $g = 200, $b = 200, $a = 100 ],
                                        ]" />
            </actions>
        </library>
        <!-- 

            validate returns

         -->
        <library name="ValidateKnown">
            <actions>
                <debug_text text="'yep ' + $Object.macro.id" />
                <do_all exact="global.$KnownTypes.count" counter="$i">
                    <do_if value="player.encyclopedia.{global.$KnownTypes.{$i}}.{$Object.macro.id}.exists">
                        <debug_text text="'yep ' + $Object.macro.id" />
                        <set_value name="$Valid" exact="true" />
                    </do_if>
                </do_all>
                <!-- <signal_cue_instantly cue="DenyAction" param="$Object" /> -->
            </actions>
        </library>
    </cues>
</mdscript>